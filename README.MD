<div align="center">

# üõí Desafio T√©cnico ‚Äî Loja Virtual Tecprime

Aplica√ß√£o full-stack de e-commerce desenvolvida como solu√ß√£o para o desafio t√©cnico da Tecprime.

![Next.js](https://img.shields.io/badge/Next.js-16-black?style=for-the-badge&logo=next.js)
![Node.js](https://img.shields.io/badge/Node.js-25-339933?style=for-the-badge&logo=node.js&logoColor=white)
![MySQL](https://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=mysql&logoColor=white)
![Docker](https://img.shields.io/badge/Docker-2496ED?style=for-the-badge&logo=docker&logoColor=white)
![Tailwind CSS](https://img.shields.io/badge/Tailwind_CSS_v4-06B6D4?style=for-the-badge&logo=tailwindcss&logoColor=white)

</div>

---

## üìã Sum√°rio

- [Introdu√ß√£o](#-introdu√ß√£o)
- [Como executar o projeto](#-como-executar-o-projeto)
- [Tecnologias utilizadas](#-tecnologias-utilizadas)
- [Banco de dados](#-banco-de-dados)
- [Decis√µes t√©cnicas](#-decis√µes-t√©cnicas)
- [Front-End](#-front-end)
  - [`/` ‚Äî P√°gina inicial](#--p√°gina-inicial)
  - [`/produtos` ‚Äî Listagem de produtos](#produtos--listagem-de-produtos)
  - [`/produtos/{nome}/{id}` ‚Äî Detalhes do produto](#produtosnomeid--detalhes-do-produto)
  - [`/login` ‚Äî Login](#login--login)
  - [`/registro` ‚Äî Cadastro](#registro--cadastro)
  - [`/conta/perfil` ‚Äî Perfil do usu√°rio](#contaperfil--perfil-do-usu√°rio)
  - [`/conta/pedido/{uuid}` ‚Äî Detalhes do pedido](#contapedidouuid--detalhes-do-pedido)
  - [`/checkout` ‚Äî Carrinho e finaliza√ß√£o de compra](#checkout--carrinho-e-finaliza√ß√£o-de-compra)
- [Back-End](#-back-end)
  - [`GET /products`](#get-products)
  - [`GET /products/:id`](#get-productsid)
  - [`POST /auth/login`](#post-authlogin)
  - [`POST /auth/register`](#post-authregister)
  - [`GET /users/`](#get-users)
  - [`POST /users/orders`](#post-usersorders)
  - [`GET /users/orders/:uuid`](#get-usersordersuuid)

---

## üìñ Introdu√ß√£o

Este projeto foi desenvolvido como solu√ß√£o para o desafio t√©cnico da Tecprime. A aplica√ß√£o √© um e-commerce completo constru√≠do com **Next.js** no front-end e **Node.js** no back-end, com as seguintes caracter√≠sticas principais:

- Autentica√ß√£o segura com **JWT** e cookies `httpOnly`
- Integra√ß√£o com a API p√∫blica [DummyJSON](https://dummyjson.com/) para listagem de produtos
- Banco de dados **MySQL** gerenciado via **Docker**
- Hash de senhas com **Argon2**, considerada a biblioteca de criptografia de senhas mais segura atualmente

---

## üöÄ Como executar o projeto

> **Pr√©-requisito:** Certifique-se de ter o [Node.js](https://nodejs.org/) e o [Docker](https://www.docker.com/) instalados em sua m√°quina.

**1. Suba o banco de dados com Docker**

```bash
docker-compose up -d
```

**2. Instale as depend√™ncias do back-end**

```bash
cd desafio-loja-backend
npm install
npm run dev
```

> O back-end j√° est√° configurado para criar automaticamente todas as tabelas, colunas e rela√ß√µes ao iniciar.

**3. Instale as depend√™ncias do front-end**

```bash
cd desafio-loja
npm install
npm run dev
```

**4. Acesse a cole√ß√£o do Postman**

Utilize [este link](https://www.postman.com/brayan-team/workspace/desafio-tecnico-loja/collection/40365310-9d52fa3a-d053-40e8-9e81-ed72e46eae92?action=share&creator=40365310&active-environment=40365310-812e4293-ee78-4e61-afe6-451e8031c020) para acessar e testar todas as rotas da API.

---

## üõ† Tecnologias utilizadas

| Camada | Tecnologia | Vers√£o |
|---|---|---|
| Front-End | Next.js | 16.0.0 |
| Estiliza√ß√£o | Tailwind CSS | v4 |
| Back-End | Node.js | 25.2.1 |
| ORM | Sequelize | ‚Äî |
| Autentica√ß√£o | JsonWebToken | ‚Äî |
| Criptografia | Argon2 | ‚Äî |
| Banco de dados | MySQL + Docker | ‚Äî |
| Gerenciamento de DB | DBeaver | ‚Äî |
| Testes de API | Postman | ‚Äî |

---

## üóÑ Banco de dados

Foram criadas **3 tabelas** com seus respectivos relacionamentos definidos via Sequelize:

- **Users** ‚Äî dados dos usu√°rios cadastrados
- **UserOrders** ‚Äî pedidos realizados pelos usu√°rios
- **OrderItems** ‚Äî itens associados a cada pedido

> O diagrama do banco de dados pode ser visualizado abaixo:

![alt text](<Captura de tela de 2026-02-22 22-54-59.png>)

---

## üí° Decis√µes t√©cnicas

### Por que Next.js em vez de React ou Angular?

As stacks padr√£o da empresa s√£o React e Angular, mas optei pelo Next.js pelos seguintes motivos:

- **Cache nativo:** o Next.js permite cachear rotas de produtos, reduzindo requisi√ß√µes desnecess√°rias
- **SSR (Server-Side Rendering):** a p√°gina j√° √© entregue ao usu√°rio com os dados renderizados, reduzindo o tempo de carregamento e melhorando a experi√™ncia
- **SEO otimizado:** todas as p√°ginas foram desenvolvidas com SEO em mente, incluindo as rotas din√¢micas de produtos
- **Middleware nativo:** o Next.js executa o middleware antes de servir qualquer p√°gina, tornando o controle de autentica√ß√£o mais robusto. No React puro, isso dependeria de providers de estado, que s√£o mais f√°ceis de contornar

### O que eu implementaria com mais tempo?

- Pagina√ß√£o na listagem de produtos (ex: 20 por p√°gina)
- Integra√ß√£o completa da busca e dos filtros com o back-end (atualmente os filtros s√£o aplicados no front-end com os dados j√° carregados)

---

## üñ• Front-End

### Estrutura de pastas

```
/app
  /(private)     ‚Üí Rotas que exigem autentica√ß√£o
  /(public)      ‚Üí Rotas acess√≠veis publicamente
/components      ‚Üí Componentes reutiliz√°veis
/hooks           ‚Üí Providers de autentica√ß√£o e carrinho
/lib             ‚Üí Fun√ß√µes base da aplica√ß√£o
/services        ‚Üí Fun√ß√µes que se comunicam com o back-end
/styles          ‚Üí CSS global
/utils           ‚Üí Fun√ß√µes utilit√°rias reutiliz√°veis
/types           ‚Üí Tipagem de dados do back-end e da aplica√ß√£o
```

---

### Rotas

#### `/` ‚Äî P√°gina inicial

P√°gina de apresenta√ß√£o com se√ß√£o de destaque e produtos em evid√™ncia.

![alt text](image.png)
![alt text](image-2.png)

**Requisi√ß√µes ao back-end (em paralelo via `Promise.all`):**
- Busca todos os produtos a partir do ID 4
- Destaca o produto de maior pre√ßo
- Exibe os produtos mais vendidos (IDs 0 a 4)

**Otimiza√ß√µes:** cache de 1 hora ¬∑ renderiza√ß√£o pelo servidor (SSR)

---

#### `/produtos` ‚Äî Listagem de produtos

Grid completo de produtos com suporte a categorias, busca por nome e ordena√ß√£o por nome ou pre√ßo.

![alt text](image-1.png)

**Requisi√ß√µes ao back-end (em paralelo via `Promise.all`):**
- Busca todos os produtos
- Busca todas as categorias
- Filtra por categoria (requisi√ß√£o ao back-end ao selecionar)

**Otimiza√ß√µes:** cache de 1 hora

---

#### `/produtos/{nome}/{id}` ‚Äî Detalhes do produto

P√°gina individual de um produto.

![alt text](image-3.png)

"Caso o produto n√£o seja encontrado, ele retorna :
![alt text](image-11.png)
---

#### `/login` ‚Äî Login

Formul√°rio de autentica√ß√£o do usu√°rio.

![alt text](image-4.png)

- Valida√ß√£o dos campos no front-end antes de enviar ao back-end
- Token armazenado via cookie `httpOnly` atrav√©s de uma fun√ß√£o `use server`, eliminando vulnerabilidades de roubo de token por XSS
- Middleware redireciona usu√°rios j√° autenticados para `/`

---

#### `/registro` ‚Äî Cadastro

Formul√°rio de cria√ß√£o de conta.

![alt text](image-5.png)

- Valida√ß√£o e tratamento de erros no front-end
- Token armazenado via `httpOnly` ao registrar com sucesso

---

#### `/conta/perfil` ‚Äî Perfil do usu√°rio

Exibe as informa√ß√µes cadastradas e o hist√≥rico de pedidos do usu√°rio.

![alt text](image-6.png)

- Renderiza√ß√£o pelo servidor (SSR)
- Cache de 1 hora

---

#### `/conta/pedido/{uuid}` ‚Äî Detalhes do pedido

Exibe todos os itens de um pedido espec√≠fico, incluindo nome, imagem e valor unit√°rio de cada produto.

![alt text](image-7.png)

- UUIDs utilizados no lugar de IDs sequenciais para reduzir a previsibilidade e dificultar ataques de enumera√ß√£o
- Renderiza√ß√£o pelo servidor (SSR)

Caso n√£o encontre, retorna :
![alt text](image-12.png)
---

#### `/checkout` ‚Äî Carrinho e finaliza√ß√£o de compra

Exibe todos os itens do carrinho, solicita o endere√ßo de entrega e o meio de pagamento, dividido em etapas.

![alt text](image-8.png)
![alt text](image-9.png)
![alt text](image-10.png)

- Carrinho persistido via cookie `carrinho_itens` no formato JSON
- Dados do pedido enviados ao back-end atrav√©s de uma fun√ß√£o `use server`
- Retorna o `uuid` do pedido criado ao finalizar a compra

**Estrutura do cookie `carrinho_itens`:**

```json
[
  {
    "produto": {
      "id": 2,
      "nome": "Eyeshadow Palette with Mirror",
      "slug": "eyeshadow-palette-with-mirror",
      "descricao": "The Eyeshadow Palette with Mirror offers a versatile range...",
      "preco": "109.95",
      "imagem": "https://cdn.dummyjson.com/product-images/beauty/eyeshadow-palette-with-mirror/thumbnail.webp",
      "categoria": "beauty",
      "destaque": false
    },
    "quantidade": 1
  }
]
```

---

## üîß Back-End

### Estrutura de pastas

```
/Controllers   ‚Üí L√≥gica de neg√≥cio (cadastro, busca etc.)
/Routes        ‚Üí Defini√ß√£o de cada rota da API
/Models        ‚Üí Defini√ß√£o das tabelas do banco de dados (Sequelize)
/Middlewares   ‚Üí Valida√ß√µes de entrada separadas da l√≥gica de neg√≥cio
/Cruds         ‚Üí Fun√ß√µes que executam opera√ß√µes no banco de dados
/Utils         ‚Üí Fun√ß√µes utilit√°rias reutiliz√°veis
```

### Padr√£o de resposta da API

Todas as respostas seguem o mesmo formato, facilitando o tratamento no front-end:

```json
{
  "msg": "Mensagem descritiva",
  "code": 200
}
```

---

### Rotas

---

#### `GET /products`

Lista produtos com suporte a filtros, ordena√ß√£o e pagina√ß√£o.

**Query params:**

| Par√¢metro | Tipo | Descri√ß√£o |
|---|---|---|
| `categories` | `string` | Filtra por categoria (3 a 50 caracteres) |
| `order` | `string` | Dire√ß√£o da ordena√ß√£o: `asc` ou `desc` |
| `sortBy` | `string` | Campo de ordena√ß√£o: `price` ou `title` |
| `limit` | `number` | Quantidade de produtos retornados (m√≠nimo 1) |
| `start` | `number` | Offset da pagina√ß√£o (m√≠nimo 0) |

**Exemplo de requisi√ß√£o:**

```
GET /products?categories=smartphones&order=desc&sortBy=price&limit=10&start=0
```

**Exemplo de resposta:**

```json
{
  "msg": "Produtos buscados com sucesso",
  "code": 200,
  "produtos": [
    {
      "id": 1,
      "nome": "Essence Mascara Lash Princess",
      "descricao": "The Essence Mascara Lash Princess is a popular mascara...",
      "preco": "R$ 54,95",
      "imagem": "https://cdn.dummyjson.com/product-images/beauty/essence-mascara-lash-princess/thumbnail.webp",
      "estoque": 99
    }
  ]
}
```

---

#### `GET /products/:id`

Retorna os detalhes de um produto espec√≠fico pelo ID.

**Path params:**

| Par√¢metro | Tipo | Descri√ß√£o |
|---|---|---|
| `id` | `number` | ID num√©rico do produto (‚â• 0) |

**Exemplo de requisi√ß√£o:**

```
GET /products/2
```

**Exemplo de resposta:**

```json
{
  "code": 200,
  "msg": "Produto buscado com sucesso",
  "produto": {
    "id": 2,
    "nome": "Eyeshadow Palette with Mirror",
    "descricao": "The Eyeshadow Palette with Mirror offers a versatile range...",
    "categoria": "beauty",
    "preco": "R$ 109,95",
    "desconto": "18.19%",
    "avaliacaoNota": "2.86 / 5",
    "estoque": 34,
    "tags": ["beauty"],
    "marca": "Glamour Beauty",
    "sku": "BEA-GLA-EYE-002",
    "peso": 9,
    "dimensoes": {
      "width": 9.26,
      "height": 22.47,
      "depth": 27.67
    },
    "informacaoGarantia": "1 year warranty",
    "informacaoEnvio": "Ships in 2 weeks",
    "statusDisponibilidade": "In Stock",
    "avaliacoes": [
      {
        "nota": 5,
        "nome": "Savannah Gomez",
        "comentario": "Great product!",
        "data": "30/04/2025",
        "email": "savannah.gomez@x.dummyjson.com"
      }
    ],
    "politicaRetorno": "7 days return policy",
    "quantidadeMinimaPedido": 20,
    "imagens": [
      "https://cdn.dummyjson.com/product-images/beauty/eyeshadow-palette-with-mirror/1.webp"
    ],
    "thumbnail": "https://cdn.dummyjson.com/product-images/beauty/eyeshadow-palette-with-mirror/thumbnail.webp"
  }
}
```

---

#### `POST /auth/login`

Autentica um usu√°rio e retorna um token JWT.

**Body:**

| Par√¢metro | Tipo | Descri√ß√£o |
|---|---|---|
| `email` | `string` | E-mail v√°lido do usu√°rio |
| `password` | `string` | Senha do usu√°rio (m√≠nimo 6 caracteres) |

**Valida√ß√µes:**
- E-mail obrigat√≥rio e com formato v√°lido
- Senha obrigat√≥ria com no m√≠nimo 6 caracteres
- Verifica√ß√£o da exist√™ncia do usu√°rio pelo e-mail
- Compara√ß√£o da senha com o hash armazenado via Argon2

**Exemplo de requisi√ß√£o:**

```json
POST /auth/login

{
  "email": "usuario@email.com",
  "password": "123456"
}
```

**Exemplo de resposta:**

```json
{
  "msg": "Login realizado com sucesso",
  "code": 200,
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

---

#### `POST /auth/register`

Cadastra um novo usu√°rio e retorna um token JWT.

**Body:**

| Par√¢metro | Tipo | Descri√ß√£o |
|---|---|---|
| `name` | `string` | Nome do usu√°rio (2 a 60 caracteres) |
| `email` | `string` | E-mail v√°lido do usu√°rio |
| `password` | `string` | Senha do usu√°rio (m√≠nimo 6 caracteres) |

**Valida√ß√µes:**
- Nome obrigat√≥rio entre 2 e 60 caracteres
- E-mail obrigat√≥rio e com formato v√°lido
- Senha obrigat√≥ria com no m√≠nimo 6 caracteres
- Verifica√ß√£o de e-mail duplicado

**Exemplo de requisi√ß√£o:**

```json
POST /auth/register

{
  "name": "Brayan Vieira",
  "email": "usuario@email.com",
  "password": "123456"
}
```

**Exemplo de resposta:**

```json
{
  "msg": "Usu√°rio cadastrado com sucesso",
  "code": 201,
  "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

---

#### `GET /users/`

Retorna os dados do usu√°rio autenticado e seus pedidos.

> üîí Requer autentica√ß√£o via token JWT no header `Authorization: Bearer {token}`

**Exemplo de resposta:**

```json
{
  "msg": "Perfil encontrado com sucesso",
  "code": 200,
  "userInfo": {
    "name": "brayan",
    "email": "vieirabrayan42@gmail.com",
    "created_at": "2026-02-23T01:28:53.000Z",
    "UserOrders": [
      {
        "uuid": "1555f8b9-40a4-48e6-bf58-8c22ce9de849",
        "address": "rua exemplo",
        "payment_method": "pix",
        "amount": "109.94",
        "status": "approved",
        "created_at": "2026-02-23T01:34:04.000Z"
      }
    ]
  }
}
```

---

#### `POST /users/orders`

Cria um novo pedido para o usu√°rio autenticado.

> üîí Requer autentica√ß√£o via token JWT no header `Authorization: Bearer {token}`

**Body:**

| Par√¢metro | Tipo | Descri√ß√£o |
|---|---|---|
| `endereco` | `string` | Endere√ßo de entrega do cliente |
| `pagamento` | `string` | M√©todo de pagamento: `pix`, `cartao` ou `boleto` |
| `produtos` | `array` | Lista de produtos do pedido |

**Estrutura de cada item em `produtos`:**

| Campo | Tipo | Descri√ß√£o |
|---|---|---|
| `id` | `number` | ID do produto |
| `quantidade` | `number` | Quantidade do produto |

**Comportamento:**
- Para cada item enviado, o sistema consulta a API de produtos e obt√©m o pre√ßo atual diretamente da fonte ‚Äî os valores enviados pelo cliente nunca s√£o utilizados
- O valor total do pedido √© calculado internamente com base nos dados reais da API
- Ap√≥s valida√ß√£o, o pedido √© salvo e um UUID √© gerado para identifica√ß√£o

**Exemplo de requisi√ß√£o:**

```json
POST /users/orders

{
  "endereco": "Rua Juscelino, 393 ‚Äî Uberl√¢ndia, MG",
  "pagamento": "pix",
  "produtos": [
    { "id": 2, "quantidade": 2 },
    { "id": 4, "quantidade": 1 }
  ]
}
```

---

#### `GET /users/orders/:uuid`

Retorna os detalhes de um pedido espec√≠fico do usu√°rio autenticado.

> üîí Requer autentica√ß√£o via token JWT no header `Authorization: Bearer {token}`

**Path params:**

| Par√¢metro | Tipo | Descri√ß√£o |
|---|---|---|
| `uuid` | `string` | Identificador √∫nico do pedido |

**Seguran√ßa:** a busca filtra simultaneamente pelo `uuid` do pedido **e** pelo `id` do usu√°rio autenticado, prevenindo vulnerabilidades de **IDOR** (Insecure Direct Object Reference), onde um usu√°rio poderia acessar pedidos de terceiros.

**Exemplo de requisi√ß√£o:**

```
GET /users/orders/1555f8b9-40a4-48e6-bf58-8c22ce9de849
Authorization: Bearer {token}
```

**Exemplo de resposta:**

```json
{
  "msg": "Pedido encontrado com sucesso",
  "code": 200,
  "pedidos": {
    "uuid": "1555f8b9-40a4-48e6-bf58-8c22ce9de849",
    "address": "rua exemplo",
    "payment_method": "pix",
    "amount": "R$ 604,67",
    "status": "approved",
    "created_at": "2026-02-23T01:34:04.000Z",
    "OrderItems": [
      {
        "id": 1,
        "name": "Eyeshadow Palette with Mirror",
        "image": "https://cdn.dummyjson.com/product-images/beauty/eyeshadow-palette-with-mirror/thumbnail.webp",
        "price": "R$ 604,67",
        "quantity": 1,
        "product_id": 2,
        "created_at": "2026-02-23T01:34:04.000Z"
      }
    ]
  }
}
```

---

<div align="center">
  Desenvolvido por <strong>Brayan Vieira</strong>
</div>
